<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PronosVIP — Matchs du jour</title>
<meta name="description" content="Pronostics VIP quotidiens basés sur les données.">
<link rel="icon" href="data:,">
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#0B0F13] text-[#E6EDF3]">
  <header class="border-b border-white/10 bg-[#0B0F13]/90 sticky top-0 z-50 backdrop-blur">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <a href="#home" class="text-xl font-bold text-[#38B6FF]">PronosVIP</a>
      <nav class="flex items-center gap-5 text-sm">
        <a class="hover:text-[#38B6FF]" href="#home">Accueil</a>
        <a class="hover:text-[#38B6FF]" href="#vip">VIP</a>
        <a class="hover:text-[#38B6FF]" href="#historique">Historique</a>
        <a class="hover:text-[#38B6FF]" href="#abonnement">Abonnement</a>
      </nav>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4">
    <!-- HOME -->
    <section id="home" data-route class="py-10">
      <h1 class="text-3xl sm:text-5xl font-semibold tracking-tight text-center">
        Pronostics VIP quotidiens, prêts à jouer
      </h1>
      <p class="mt-4 text-white/70 max-w-2xl mx-auto text-center">
        Les matchs du <span id="dateLabel"></span> sont chargés en direct depuis notre API.
      </p>

      <section class="mt-10">
        <div class="flex items-center justify-between flex-wrap gap-3">
          <h2 class="text-2xl font-semibold">Matchs du jour (Football)</h2>
          <div class="text-sm text-white/60">Fuseau : Africa/Libreville</div>
        </div>

        <div id="fixturesWrap" class="grid md:grid-cols-2 gap-4 mt-5">
          <!-- Cartes injectées -->
        </div>

        <div id="loading" class="text-white/60 mt-6">Chargement des matchs en temps réel…</div>
        <div id="empty" class="hidden text-white/60 mt-6">Aucun match trouvé pour aujourd’hui.</div>
        <div id="error" class="hidden text-rose-400 mt-6">Erreur de chargement. Vérifie la fonction <code>/api/fixtures</code> et la clé d’API.</div>
      </section>

      <section class="mt-12">
        <h3 class="text-xl font-semibold mb-2">Comment ça marche ?</h3>
        <ul class="list-disc list-inside text-white/80 space-y-1">
          <li>Le navigateur appelle <code>/api/fixtures</code> (fonction serverless Vercel).</li>
          <li>La fonction interroge <b>API-SPORTS</b> avec ta clé (cachée côté serveur).</li>
          <li>Les résultats (matchs réels du jour) s’affichent ci-dessus.</li>
        </ul>
      </section>
    </section>

    <!-- Sections décoratives (maquette) -->
    <section id="vip" data-route class="py-10 hidden">
      <h2 class="text-2xl font-semibold">Espace VIP</h2>
      <p class="text-white/70 mt-2">Connecte ton backend (picks, cotes, analyses IA) pour alimenter cette section.</p>
    </section>

    <section id="historique" data-route class="py-10 hidden">
      <h2 class="text-2xl font-semibold">Historique</h2>
      <p class="text-white/70 mt-2">À brancher à ta base (ex: Supabase) pour lister les résultats passés.</p>
    </section>

    <section id="abonnement" data-route class="py-10 hidden">
      <h2 class="text-2xl font-semibold">Abonnement</h2>
      <p class="text-white/70 mt-2">Intègre Stripe pour vendre l’accès VIP.</p>
    </section>
  </main>

  <footer class="border-t border-white/10 mt-12 py-8 text-center text-sm text-white/60">
    © 2025 PronosVIP — Contenu informatif, ne garantit aucun gain. Jouez responsable.
  </footer>

<script>
/* --- mini-router hash --- */
const routes = Array.from(document.querySelectorAll('[data-route]'));
function showRoute(hash){
  const id = (hash || '#home').replace('#','');
  routes.forEach(s => s.classList.add('hidden'));
  (document.getElementById(id) || document.getElementById('home')).classList.remove('hidden');
  window.scrollTo({top:0, behavior:'instant'});
}
window.addEventListener('hashchange', ()=>showRoute(location.hash));
showRoute(location.hash);

/* --- date (Africa/Libreville) --- */
const tz = 'Africa/Libreville';
const now = new Date();
document.getElementById('dateLabel').textContent =
  new Intl.DateTimeFormat('fr-FR', { dateStyle: 'full', timeZone: tz }).format(now);

/* --- render cartes --- */
function card(fx){
  const dt = new Date(fx.date_local);
  const dStr = new Intl.DateTimeFormat('fr-FR', { day:'2-digit', month:'2-digit', year:'numeric', timeZone: tz }).format(dt);
  const tStr = new Intl.DateTimeFormat('fr-FR', { hour:'2-digit', minute:'2-digit', hour12:false, timeZone: tz }).format(dt);
  return `
  <article class="rounded-lg border border-white/10 bg-[#121820]/80 p-5">
    <div class="text-sm text-white/60 flex justify-between">
      <span>${fx.league}</span>
      <span>${dStr} • ${tStr}</span>
    </div>
    <h3 class="text-lg font-semibold mt-1">${fx.home} vs ${fx.away}</h3>
    <p class="text-white/70 text-sm mt-2">ID fixture: ${fx.id}</p>
  </article>`;
}

/* --- fetch real fixtures from our serverless function --- */
async function loadFixtures(){
  const loading = document.getElementById('loading');
  const empty = document.getElementById('empty');
  const error = document.getElementById('error');
  const wrap = document.getElementById('fixturesWrap');

  loading.classList.remove('hidden');
  empty.classList.add('hidden'); error.classList.add('hidden'); wrap.innerHTML = '';

  // On demande les matchs pour la date locale africa/Libreville (la fonction s’en charge aussi côté serveur)
  const dateParam = new Intl.DateTimeFormat('en-CA', { timeZone: tz }).format(now); // YYYY-MM-DD
  try {
    const res = await fetch(`/api/fixtures?date=${dateParam}&sport=football`);
    if(!res.ok) throw new Error(await res.text());
    const json = await res.json();
    const items = json.fixtures || [];
    if(items.length === 0){ empty.classList.remove('hidden'); return; }
    wrap.innerHTML = items.map(card).join('');
  } catch(e){
    console.error(e);
    error.classList.remove('hidden');
  } finally {
    loading.classList.add('hidden');
  }
}
loadFixtures();
</script>
</body>
</html>